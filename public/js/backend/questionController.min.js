app.controller("QuestionController",function(n,t,e,i){function o(){t.get(app.baseUrl+"admin/api/level").then(function(t){n.levels=t.data,console.log(n.levels)})}function a(n){var t={bottom:!1,top:!0,left:!1,right:!0};t=angular.extend({},t),e.show(e.simple().textContent(n).position("bottom right").hideDelay(3500))}function s(e,i,o,s,r){n.toggleError=!0,t.post(app.baseUrl+e,i).then(function(t){l(),1===r&&a(o),n.toggle=!0,n.toggleError=!1},function(t){1===r&&a(s),n.toggleError=!1})}function l(){console.log(n.question),t.get(app.baseUrl+"admin/api/question/"+n.question.category_id).then(function(t){n.data=t.data})}n.data=null,n.toggle=!0,n.toggleError=!1,n.action="ADD",n.levels=null,o(),n.checkLevel=function(t){var e=$.grep(n.levels,function(n){return n.id===t.id});return e[0].title},n.question={category_id:$(".category_id").val(),question:"",levels_id:0,answer:[{content:"",isRight:1}]},n.toggleClick=function(e,i){n.action=i||"",null===e?n.question={category_id:$(".category_id").val(),question:"",levels_id:0,answer:[{content:"",isRight:1}]}:t.get(app.baseUrl+"admin/api/question/show/"+e.id).then(function(t){n.question=t.data,console.log(t.data)}),n.toggle=!n.toggle},n.isRight=function(t){for(var e=0;e<n.question.answer.length;e++)n.question.answer[e].isRight=t.$$hashKey===n.question.answer[e].$$hashKey?1:0},n.removeAnswer=function(t){var e=n.question.answer.indexOf(t);n.question.answer.splice(e,1)},n.addAnswer=function(){var t={content:"",isRight:0};n.question.answer.push(t)},n.saveQuestion=function(){"ADD"===n.action?s("admin/api/question/store",n.question,"Thêm câu hỏi mới thành công","Có lỗi xảy ra!",1):s("admin/api/question/update",n.question,"Cập nhật câu hỏi thành công","Có lỗi xảy ra!",1)},n.deleteQuestion=function(n){var t=i.confirm().title("Cảnh báo").textContent("Bạn có muốn xóa câu hỏi này?").ok("Đồng ý").cancel("Hủy");i.show(t).then(function(){s("admin/api/question/delete",n,"Xóa câu hỏi thành công","Lỗi! xin thử lại",1)})},l()});